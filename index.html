<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>羞涩测评 - 每一种好奇值得被认真探索</title>
    <script src="https://cdn.tailwindcss.com/3.3.3"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+SC:wght@400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #faf6f2;
            color: #5a4a42;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background-color: #e8b4b8;
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: #d8a0a4;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .option-btn {
            border: 1px solid #e8b4b8;
            transition: all 0.3s ease;
        }
        
        .option-btn:hover {
            background-color: #f8e0e2;
        }
        
        .option-btn.selected {
            background-color: #e8b4b8;
            color: white;
        }
        
        .progress-bar {
            height: 6px;
            background-color: #f0e6e6;
            border-radius: 3px;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #e8b4b8;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        .result-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        
        .bottle {
            width: 30px;
            background-color: #f0e6e6;
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }
        
        .water {
            position: absolute;
            bottom: 0;
            width: 100%;
            background-color: #e8b4b8;
            transition: height 0.5s ease;
        }
        
        .question-box {
            background-color: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .option-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        @media (max-width: 640px) {
            .question-text {
                font-size: 16px;
            }
            
            .option-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- 首页 -->
        <div id="home-page" class="text-center">
            <h1 class="text-3xl md:text-4xl font-bold mb-6 text-[#5a4a42]">每一种好奇值得被认真探索</h1>
            <div class="flex justify-center mb-6">
                <img src="https://lf-code-agent.coze.cn/obj/x-ai-cn/page_image/fd28aa43d8ab16f3d37ccd048067fca6.png" 
                     alt="测评封面图" 
                     class="w-1/2 rounded-full object-cover aspect-square">
            </div>
            <p class="text-lg md:text-xl mb-8 text-[#7a6a62]">在亲密互动中，你是否会喜欢羞涩的感觉<br>如果是，那这份问卷可以和你一起探究另一面的自己<br>因什么触动，被什么唤起，又为什么着迷<br>Don't worry，这种喜欢不奇怪，它很具体</p>
            <button id="start-btn" class="btn-primary px-8 py-3 rounded-full text-lg font-medium">开始探索</button>
        </div>

        <!-- 问卷区 -->
        <div id="survey-page" class="hidden">
            <h2 class="text-2xl font-bold mb-6 text-center text-[#5a4a42]">想象你是否会喜欢下列场景</h2>
            
            <div class="progress-bar mb-6">
                <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
            </div>
            
            <div id="question-container" class="space-y-4">
                <!-- 问题将通过JS动态生成 -->
            </div>
            
            <div class="flex justify-between mt-8">
                <button id="prev-btn" class="px-6 py-2 rounded-full border border-[#e8b4b8] text-[#e8b4b8] font-medium hidden">上一页</button>
                <button id="next-btn" class="px-6 py-2 rounded-full border border-[#e8b4b8] text-[#e8b4b8] font-medium">下一页</button>
            </div>
        </div>

        <!-- 结果展示区 -->
        <div id="result-page" class="hidden">
            <h2 class="text-2xl font-bold mb-8 text-center text-[#5a4a42]">你的羞涩测评结果</h2>
            
            <div class="space-y-8">
                <!-- 区块1 -->
                <div id="result-type" class="result-card p-6 hidden">
                    <h3 class="text-xl font-bold mb-4 text-[#5a4a42]">什么样的反差令你心动</h3>
                    <div id="type-content" class="space-y-4"></div>
                </div>
                
                <!-- 区块2 -->
                <div id="result-method" class="result-card p-6 hidden">
                    <h3 class="text-xl font-bold mb-4 text-[#5a4a42]">什么样的方式能强化你的感受</h3>
                    <div id="method-content" class="space-y-4"></div>
                </div>
                
                <!-- 区块3 -->
                <div id="result-bottle" class="result-card p-6">
                    <h3 class="text-xl font-bold mb-4 text-center text-[#5a4a42]">亲密玩法小瓶子</h3>
                    <div class="flex justify-center">
                        <div class="grid grid-cols-3 gap-4">
                            <div class="text-center">
                                <div class="bottle mx-auto mb-2" style="height: 120px;">
                                    <div id="bottle-1" class="water" style="height: 0%"></div>
                                </div>
                                <p class="text-sm">被迫变得"凉快"</p>
                            </div>
                            <div class="text-center">
                                <div class="bottle mx-auto mb-2" style="height: 120px;">
                                    <div id="bottle-2" class="water" style="height: 0%"></div>
                                </div>
                                <p class="text-sm">严肃的训话</p>
                            </div>
                            <div class="text-center">
                                <div class="bottle mx-auto mb-2" style="height: 120px;">
                                    <div id="bottle-3" class="water" style="height: 0%"></div>
                                </div>
                                <p class="text-sm">按"规矩"训诫</p>
                            </div>
                            <div class="text-center">
                                <div class="bottle mx-auto mb-2" style="height: 120px;">
                                    <div id="bottle-4" class="water" style="height: 0%"></div>
                                </div>
                                <p class="text-sm">沉默的注视</p>
                            </div>
                            <div class="text-center">
                                <div class="bottle mx-auto mb-2" style="height: 120px;">
                                    <div id="bottle-5" class="water" style="height: 0%"></div>
                                </div>
                                <p class="text-sm">brat的教训</p>
                            </div>
                            <div class="text-center">
                                <div class="bottle mx-auto mb-2" style="height: 120px;">
                                    <div id="bottle-6" class="water" style="height: 0%"></div>
                                </div>
                                <p class="text-sm">"正经"的反差</p>
                            </div>
                            <div class="text-center">
                                <div class="bottle mx-auto mb-2" style="height: 120px;">
                                    <div id="bottle-7" class="water" style="height: 0%"></div>
                                </div>
                                <p class="text-sm">被抓包心慌慌</p>
                            </div>
                            <div class="text-center">
                                <div class="bottle mx-auto mb-2" style="height: 120px;">
                                    <div id="bottle-8" class="water" style="height: 0%"></div>
                                </div>
                                <p class="text-sm">红温aftercare</p>
                            </div>
                            <div class="text-center">
                                <div class="bottle mx-auto mb-2" style="height: 120px;">
                                    <div id="bottle-9" class="water" style="height: 0%"></div>
                                </div>
                                <p class="text-sm">直视我的眼睛</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 区块4 -->
                <div id="result-combo" class="result-card p-6 hidden">
                    <h3 class="text-xl font-bold mb-4 text-[#5a4a42]">我最喜欢的组合</h3>
                    <div id="combo-content" class="space-y-4"></div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="mt-12 py-6 text-center text-[#7a6a62]">
        <p>Designed by 阿狸&边边</p>
    </footer>

    <script id="survey-data" type="application/json">
        // 问卷数据
        const questions = [
            // 第1页
            [
                "在对方安静专注的目光下，缓慢脱去衣服的过程，我能体会到心理上明确的拉扯感",
                "走廊里灯光昏暗，把对方把我的眼睛蒙上然后拉到镜子前面，揭开后让我看着镜子里羞涩的自己",
                "被对方冷下声音，严肃要求'脱掉某件衣服'，并要求自己说出现在是什么身份，等下要被怎么样",
                "当裙子被卷到腰间，对方问'今天是乖小孩吗，为什么裙子会在腰间呢'",
                "衣物被部分推开，露出局部皮肤感知到空调的凉意，比全裸更让我害羞。",
                "短裤挂在脚踝，行动时有明显的拘束感，但是不能完全脱掉。"
            ],
            // 第2页
            [
                "在会议室里突然接到对方的电话，听筒对面低声喊出了你们约定的特殊称呼",
                "在安静的空间里，被示意捧起戒尺站在墙角，对方沉默的注视让我觉得紧张。",
                "在路上撒娇，被威胁再不听话要挨揍的时候，小声地说'我错了不罚了好不好'",
                "对方笑着看着我说，有的人在外面正儿八经，而回到家就是我的puppy呢",
                "当我被要求保持跪姿，被牵引着跟随时，会觉得害羞。",
                "在身体接触中被引导到'宠物'等姿态，会让我有强烈的羞耻感。"
            ],
            // 第3页
            [
                "当对方故意停顿、沉默，似乎在等我承认内心的小心思时，我会感到脸热。",
                "对方在书桌上放置戒尺，并用表情暗示'今天一定不会好过'，让我觉得无处可逃。",
                "对方逼问我'想要什么，说出来才可能得到哦'，会让我变得更加渴望",
                "对方要求我反复且清晰陈述自己的想法和错误时，我觉得张不开口，在被迫说出后会更加害羞。",
                "对方靠近我的耳边，呼吸声清晰可见，说话的温热的气息扑在耳朵，会让我更红温。",
                "在我还没承认之前，对方抬起我的下巴要求直视眼睛，会让我羞得想躲。"
            ]
        ];

        // 用户答案
        const answers = Array(18).fill(0);
        let currentPage = 0;

        // DOM元素
        const homePage = document.getElementById('home-page');
        const surveyPage = document.getElementById('survey-page');
        const resultPage = document.getElementById('result-page');
        const questionContainer = document.getElementById('question-container');
        const progressFill = document.getElementById('progress-fill');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const startBtn = document.getElementById('start-btn');

        // 初始化问卷
        function initSurvey() {
            homePage.classList.add('hidden');
            surveyPage.classList.remove('hidden');
            renderQuestions(currentPage);
            updateProgress();
            window.scrollTo(0, 0);
        }

        // 渲染问题
        function renderQuestions(page) {
            questionContainer.innerHTML = '';
            
            questions[page].forEach((q, index) => {
                const questionIndex = page * 6 + index;
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-box';
                
                questionDiv.innerHTML = `
                    <p class="question-text mb-3">${q}</p>
                    <div class="option-grid">
                        <button class="option-btn px-4 py-2 rounded-full ${answers[questionIndex] === 1 ? 'selected' : ''}" data-index="${questionIndex}" data-value="1">非常讨厌</button>
                        <button class="option-btn px-4 py-2 rounded-full ${answers[questionIndex] === 2 ? 'selected' : ''}" data-index="${questionIndex}" data-value="2">一般无感</button>
                        <button class="option-btn px-4 py-2 rounded-full ${answers[questionIndex] === 3 ? 'selected' : ''}" data-index="${questionIndex}" data-value="3">比较喜欢</button>
                        <button class="option-btn px-4 py-2 rounded-full ${answers[questionIndex] === 4 ? 'selected' : ''}" data-index="${questionIndex}" data-value="4">非常喜欢</button>
                    </div>
                `;
                
                questionContainer.appendChild(questionDiv);
            });
            
            // 添加选项点击事件
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.dataset.index);
                    const value = parseInt(this.dataset.value);
                    
                    // 更新答案
                    answers[index] = value;
                    
                    // 更新按钮样式
                    document.querySelectorAll(`[data-index="${index}"]`).forEach(b => {
                        b.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
            });
            
            // 更新导航按钮状态
            prevBtn.classList.toggle('hidden', page === 0);
            nextBtn.textContent = page === questions.length - 1 ? '查看结果' : '下一页';
        }

        // 更新进度条
        function updateProgress() {
            const answeredCount = answers.filter(a => a > 0).length;
            const progress = (answeredCount / answers.length) * 100;
            progressFill.style.width = `${progress}%`;
        }

        // 计算得分
        function calculateScores() {
            const typeScores = {
                "衣着反差": 0,
                "身份反差": 0,
                "想法反差": 0
            };
            
            const methodScores = {
                "氛围": 0,
                "语言": 0,
                "身体": 0
            };
            
            const comboScore = {
                "氛围*衣着反差": 0,
                "语言*衣着反差": 0,
                "身体*衣着反差": 0,
                "氛围*身份反差": 0,
                "语言*身份反差": 0,
                "身体*身份反差": 0,
                "氛围*想法反差": 0,
                "语言*想法反差": 0,
                "身体*想法反差": 0
            };
            
            // 计算类型和方法得分
            questions.forEach((page, pageIndex) => {
                page.forEach((q, qIndex) => {
                    const answerIndex = pageIndex * 6 + qIndex;
                    // 根据问题顺序确定类型和方法
                    let type, method;
                    if (pageIndex === 0) {
                        type = "衣着反差";
                        if (qIndex < 2) method = "氛围";
                        else if (qIndex < 4) method = "语言";
                        else method = "身体";
                    } else if (pageIndex === 1) {
                        type = "身份反差";
                        if (qIndex < 2) method = "氛围";
                        else if (qIndex < 4) method = "语言";
                        else method = "body";
                    } else {
                        type = "想法反差";
                        if (qIndex < 2) method = "氛围";
                        else if (qIndex < 4) method = "语言";
                        else method = "身体";
                    }
                    
                    typeScores[type] += answers[answerIndex];
                    methodScores[method] += answers[answerIndex];
                });
            });
            
            // 计算组合得分
            comboScore["氛围*衣着反差"] = typeScores["衣着反差"] * methodScores["氛围"];
            comboScore["语言*衣着反差"] = typeScores["衣着反差"] * methodScores["语言"];
            comboScore["身体*衣着反差"] = typeScores["衣着反差"] * methodScores["身体"];
            comboScore["氛围*身份反差"] = typeScores["身份反差"] * methodScores["氛围"];
            comboScore["语言*身份反差"] = typeScores["身份反差"] * methodScores["语言"];
            comboScore["身体*身份反差"] = typeScores["身份反差"] * methodScores["身体"];
            comboScore["氛围*想法反差"] = typeScores["想法反差"] * methodScores["氛围"];
            comboScore["语言*想法反差"] = typeScores["想法反差"] * methodScores["语言"];
            comboScore["身体*想法反差"] = typeScores["想法反差"] * methodScores["身体"];
            
            return { typeScores, methodScores, comboScore };
        }

        // 显示结果
        function showResults() {
            const { typeScores, methodScores, comboScore } = calculateScores();
            
            surveyPage.classList.add('hidden');
            resultPage.classList.remove('hidden');
            window.scrollTo(0, 0);
            
            // 区块1: 喜欢的反差类型
            const typeContent = document.getElementById('type-content');
            typeContent.innerHTML = '';
            
            if (typeScores["衣着反差"] > 14) {
                typeContent.innerHTML += `
                    <div class="p-4 bg-[#f8f0ee] rounded-lg">
                        <h4 class="font-bold mb-2">衣着反差</h4>
                        <p class="text-sm">脱掉"穿在身上的遮挡"→ 涉及外在形象、服饰、身体的暴露感。</p>
                    </div>
                `;
            }
            
            if (typeScores["身份反差"] > 14) {
                typeContent.innerHTML += `
                    <div class="p-4 bg-[#f8f0ee] rounded-lg">
                        <h4 class="font-bold mb-2">身份反差</h4>
                        <p class="text-sm">摘下"正经社交的面具"→ 涉及平时严肃/理智/专业的外在形象与游戏形象的反差感。</p>
                    </div>
                `;
            }
            
            if (typeScores["想法反差"] > 14) {
                typeContent.innerHTML += `
                    <div class="p-4 bg-[#f8f0ee] rounded-lg">
                        <h4 class="font-bold mb-2">想法反差</h4>
                        <p class="text-sm">暴露"藏起来的小心思"→ 涉及隐秘的欲望、幻想、弱点被察觉或暴露的心理赤裸感。</p>
                    </div>
                `;
            }
            
            if (typeContent.innerHTML === '') {
                typeContent.innerHTML = `
                    <div class="p-4 bg-[#f8f0ee] rounded-lg">
                        <p class="text-sm">我没有猜到你特别钟爱的反差类型呢</p>
                    </div>
                `;
            }
            document.getElementById('result-type').classList.remove('hidden');
            
            // 区块2: 喜欢的方式
            const methodContent = document.getElementById('method-content');
            methodContent.innerHTML = '';
            
            if (methodScores["氛围"] > 14) {
                methodContent.innerHTML += `
                    <div class="p-4 bg-[#f8f0ee] rounded-lg">
                        <h4 class="font-bold mb-2">氛围</h4>
                        <p class="text-sm">沉默的施压，通过环境、仪式感、情境设定等方式让人自然进入羞耻状态。</p>
                    </div>
                `;
            }
            
            if (methodScores["语言"] > 14) {
                methodContent.innerHTML += `
                    <div class="p-4 bg-[#f8f0ee] rounded-lg">
                        <h4 class="font-bold mb-2">语言</h4>
                        <p class="text-sm">通过称呼、直接描述、逼问、挑逗话语触发羞涩的感觉。</p>
                    </div>
                `;
            }
            
            if (methodScores["身体"] > 14) {
                methodContent.innerHTML += `
                    <div class="p-4 bg-[#f8f0ee] rounded-lg">
                        <h4 class="font-bold mb-2">身体</h4>
                        <p class="text-sm">借由动作制造被迫感与无处可逃感。</p>
                    </div>
                `;
            }
            
            if (methodContent.innerHTML === '') {
                methodContent.innerHTML = `
                    <div class="p-4 bg-[#f8f0ee] rounded-lg">
                        <p class="text-sm">还不太确定你是否喜欢羞耻的感受，如果不喜欢，亲密关系中就不需要强化哦</p>
                    </div>
                `;
            }
            document.getElementById('result-method').classList.remove('hidden');
            
            // 区块3: 瓶子图 - 更新计算逻辑
            Object.keys(comboScore).forEach((key, index) => {
                const score = comboScore[key];
                const height = Math.max(0, ((score - 16) / (576 - 16)) * 100);
                document.getElementById(`bottle-${index + 1}`).style.height = `${height}%`;
            });
            
            // 区块4: 最喜欢的组合
            const comboContent = document.getElementById('combo-content');
            comboContent.innerHTML = '';
            
            // 筛选得分大于144的组合并按得分从高到低排序
            const filteredCombos = Object.entries(comboScore)
                .filter(([_, score]) => score > 144)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3);
            
            if (filteredCombos.length > 0) {
                filteredCombos.forEach(([combo, score]) => {
                    let description = '';
                    
                    switch(combo) {
                        case "氛围*衣着反差":
                            description = "害羞来源于'被看见变化'的过程";
                            break;
                        case "语言*衣着反差":
                            description = "语言是启动器，命令或描述让你感到被关注和掌控";
                            break;
                        case "身体*衣着反差":
                            description = "肢体接触直接触发害羞和兴奋";
                            break;
                        case "氛围*身份反差":
                            description = "喜欢被从日常权威或独立的角色，放置到柔弱/顺从的位置";
                            break;
                        case "语言*身份反差":
                            description = "喜欢语言打破社交面具，让你完全变成'另一种人'";
                            break;
                        case "身体*身份反差":
                            description = "用身体动作打破日常形象，让你切换成被动模式";
                            break;
                        case "氛围*想法反差":
                            description = "被无声地'看透'让你心虚，感到内心慌乱";
                            break;
                        case "语言*想法反差":
                            description = "直白揭穿内心的小欲望会让你羞到想逃";
                            break;
                        case "身体*想法反差":
                            description = "通过肢体的强势强迫你面对自己的欲望";
                            break;
                    }
                    
                    comboContent.innerHTML += `
                        <div class="p-4 bg-[#f8f0ee] rounded-lg">
                            <h4 class="font-bold mb-2">${combo}</h4>
                            <p class="text-sm">${description}</p>
                        </div>
                    `;
                });
                
                document.getElementById('result-combo').classList.remove('hidden');
            }
        }

        // 事件监听
        startBtn.addEventListener('click', initSurvey);
        
        prevBtn.addEventListener('click', function() {
            if (currentPage > 0) {
                currentPage--;
                renderQuestions(currentPage);
                updateProgress();
                window.scrollTo(0, 0);
            }
        });
        
        nextBtn.addEventListener('click', function() {
            // 检查当前页是否已回答所有问题
            const startIndex = currentPage * 6;
            const endIndex = startIndex + 6;
            const pageAnswers = answers.slice(startIndex, endIndex);
            
            if (pageAnswers.includes(0)) {
                alert('请回答当前页的所有问题后再继续');
                return;
            }
            
            if (currentPage < questions.length - 1) {
                currentPage++;
                renderQuestions(currentPage);
                updateProgress();
                window.scrollTo(0, 0);
            } else {
                showResults();
            }
        });
    </script>
    <script>
        // 提取问卷数据
        const surveyData = JSON.parse(document.getElementById('survey-data').textContent);

        // 打印问卷数据，查看是否正确提取
        console.log(surveyData);

        // Formspree的表单提交URL
        const formspreeEndpoint = 'https://formspree.io/f/{your-form-id}';

        // 表单提交处理
        document.getElementById('survey-form').addEventListener('submit', function(event) {
            event.preventDefault();

            // 获取表单数据
            const formData = new FormData(event.target);
            const data = {};

            // 将FormData转换成对象
            formData.forEach((value, key) => {
                data[key] = value;
            });

            // 添加问卷问题及用户选择的答案
            data.surveyQuestions = surveyData.questions.map(q => {
                return {
                    question: q.question,
                    answer: data[q.id] || 'No answer'  // 获取用户选择的答案，如果没有填写则显示 'No answer'
                };
            });

            // 使用Fetch发送JSON请求
            fetch(formspreeEndpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
            .then(response => response.json())
            .then(responseData => {
                alert('Form submitted successfully!');
                console.log(responseData);
            })
            .catch(error => {
                alert('There was an error submitting the form.');
                console.error('Error:', error);
            });
        });
    </script>
</body>
</html>
